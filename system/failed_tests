#!/usr/bin/env bash
shopt -s nullglob

ALL=$( find ~/.tests/scripts        -type f | wc -l)
PASS=$(find ~/.tests/results/pass   -type f | wc -l)
RUN=$( find ~/.tests/results/stdout -type f | wc -l)
DIFF=$(( RUN - PASS ))

EXTRA=""
[[ "$ALL" -eq "$RUN" ]] || EXTRA=" so far"

if [[ "$DIFF" -gt 0 ]]
then
    echo "<fc=#FF0000>${PASS}/${RUN} passed${EXTRA}</fc>"
else
    echo "<fc=#00FF00>${PASS}/${RUN} passed${EXTRA}</fc>"
fi

[[ "x$1" = "xshow" ]] || exit 0

for TEST in ~/.tests/scripts/*
do
    NAME=$(basename "$TEST")
    [[ -e "/home/chris/.tests/results/stdout/$NAME" ]] || continue
    [[ -e "/home/chris/.tests/results/pass/$NAME"   ]] || echo "$NAME"
done
