#!/usr/bin/env bash
shopt -s nullglob

    ALL=$(ls ~/System/Tests/scripts/         | wc -l)
SUCCESS=$(ls ~/System/Tests/results/success/ | wc -l)
RUNNING=$(ls ~/System/Tests/results/running/ | wc -l)

DIFF=$(( RUN - SUCCESS ))

EXTRA=""
[[ "$RUNNING" -ne 0 ]] || EXTRA=" so far"

HEX="#00FF00"
[[ "$DIFF" -gt 0 ]] && HEX="#FF0000"

echo "<fc=${HEX}>${SUCCESS}/${ALL} passed${EXTRA}</fc>"

[[ "x$1" = "xshow" ]] || exit 0

echo "SUCCESS: $SUCCESS"
echo "RUNNING: $RUNNING"
echo "ALL: $ALL"

echo "Passed:"
ls ~/System/Tests/results/success
echo ""

echo "Not run:"
for TEST in ~/.tests/scripts/*
do
    NAME=$(basename "$TEST")
    [[ -e ~/System/Tests/results/stdout/"$NAME" ]] || echo "$NAME"
done
echo ""

echo "Failures:"
for TEST in ~/System/Tests/scripts/*
do
    NAME=$(basename "$TEST")
    [[ -e ~/.tests/results/stdout/"$NAME"  ]] || continue
    [[ -e ~/.tests/results/success/"$NAME" ]] || echo "$NAME"
done
